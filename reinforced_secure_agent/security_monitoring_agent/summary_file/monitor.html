<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ê³µê²© ë¡œê·¸ + ëŒ€ì‘ì±… ëª¨ë‹ˆí„°ë§</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f8f9fa;
      padding: 20px;
    }
    .card {
      background: white;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .threat {
      border-left: 6px solid #dc3545;
    }
    .response {
      border-left: 6px solid #28a745;
    }
    .card h3 {
      margin-top: 0;
    }
    .card pre {
      white-space: pre-wrap;
      background: #f1f1f1;
      padding: 12px;
      border-radius: 6px;
      font-size: 15px;
      font-family: "Courier New", Consolas, monospace;
      line-height: 1.6;
      color: #333;
    }
  </style>
</head>
<body>
  <h1>ğŸ“¡ ê³µê²© íƒì§€ ë° ëŒ€ì‘ ëª¨ë‹ˆí„°ë§</h1>
  <div id="logArea"></div>

  <script>
    const logArea = document.getElementById('logArea');

    fetch('summary_log.txt')
      .then(res => res.text())
      .then(text => {
        const lines = text.split('\n');
        const groups = [];
        let currentGroup = { problems: [], response: '' };
        let inResponse = false;

        for (let line of lines) {
          line = line.trim();
          if (line === '') continue;

          // ëŒ€ì‘ì±… ì‹œì‘
          if (line.includes('ëŒ€ì‘ì±… ì •ë¦¬')) {
            inResponse = true;
            continue;
          }

          // ìƒˆ ê·¸ë£¹ ì‹œì‘ ê¸°ì¤€ (ì˜ˆ: ==== í˜¹ì€ --- ìš”ì•½ ì‹œê° ë“±)
          if (line.startsWith('====') || line.startsWith('---')) {
            if (currentGroup.problems.length > 0 || currentGroup.response) {
              groups.push(currentGroup);
              currentGroup = { problems: [], response: '' };
            }
            inResponse = false;
            continue;
          }

          if (inResponse) {
            currentGroup.response += line + '\n';
          } else {
            if (line.includes('|') && !line.includes('ì‹œê°„')) {
              const parts = line.split('|').map(p => p.trim());
              if (parts.length >= 5) {
                currentGroup.problems.push({
                  time: parts[0],
                  ip: parts[1],
                  port: parts[2],
                  type: parts[3],
                  desc: parts[4]
                });
              }
            }
          }
        }

        if (currentGroup.problems.length > 0 || currentGroup.response) {
          groups.push(currentGroup);
        }

        // DOM ë Œë”ë§
        groups.forEach((group, idx) => {
          group.problems.forEach((p, i) => {
            const div = document.createElement('div');
            div.className = 'card threat';
            div.innerHTML = `
              <h3>ğŸš¨ ìœ„í˜‘: ${p.type}</h3>
              <p><strong>ì‹œê°„:</strong> ${p.time}</p>
              <p><strong>IP:</strong> ${p.ip}</p>
              <p><strong>í¬íŠ¸:</strong> ${p.port}</p>
              <p><strong>ì„¤ëª…:</strong> ${p.desc}</p>
            `;
            logArea.appendChild(div);
          });

          if (group.response.trim()) {
            const div = document.createElement('div');
            div.className = 'card response';
            div.innerHTML = `<h3>ğŸ› ï¸ ëŒ€ì‘ì±… (ë¬¸ì œ ${idx + 1} ê·¸ë£¹)</h3><pre>${group.response.trim()}</pre>`;
            logArea.appendChild(div);
          }
        });
      });
  </script>
</body>
</html>
